import numpy as np

jets = ">>><<>>><><<>>>><<<>><>>><<<<>>>><<><<>>><<<<><>>>><<<<>>><<>><>><<<>>>><><<<>>>><<>><<>>><<<>>><<>>>><>>>><<<>>>><<<<><>>>><<<<>><<<<>>><>><>>>><>>>><><<<>>>><<<<>>>><<>>>><<<<>>><<<>>><<<<><<>><<<><<<>>>><>><>>>><<<<>><>>><<>>><<><<>>>><<<<>>><<>>><>>><>>>><<<<>><<<>><<<<>>>><<>>><<><<>><<>><>><<>>>><><<<<>>>><<><>><><<>><<<<>><<<<>>><<<<>>>><>>><><<<>>>><<<<>><<>><<<<>>>><<<<>>><>>>><<<><<><<>><><<>>><>>>><<>>><<<<><<<><>>><>><<<>>><<<>>>><<<>>><<>>>><<<>><<<<>>>><<<>>><<<><<<<><<<>>><>><>>>><<<<><<>>><<<<>>><<><<<<><<<>><<>><>><<<<>>><<<>>><<<<><<>>><<<<><<<><<<<>>><<<<>>>><<>>><<><<<<>>>><<>>><<><<<><<>><<<<><<<>>><<<<>>>><<>><<<<>><>><>><>>><><<<>><<>><>>><>><<<><>>>><>>><<><>>><<>>>><>>>><>><<>>>><>><<<<><<<<>>><<<<>><<>>><>>><<<<><<<<>>>><<<<>><<<<>>>><<<<>><<<><<<>>><<><<>>>><>><<<<>>><<>>>><<<>><<<>>>><<>><<><<<<>>>><><<<<>>>><><<>><<<<>>><<>>>><<<<>>>><><>><<<>>><<<<><<<>><<>>>><<<>>><<<<>>>><>>><>>><<>>>><<<>>>><<<>>><<>>>><<>><<>>><>><<<>>><<<>>>><<<>><<<<><<<>>><<<>>><<>><<<>><<<<>>><<>>>><<<<>>>><>>><>><<<>><<<><<<<><>><<<<>>><<<<><>>>><<<>><<<><<<<><<<<>>>><<<<>><<<>><<<><<>><<<>>><<<<><<>>>><<>>><<>>>><>>>><<<>>><<<>><<<<>><<<><>><><<<<>>><>>>><<>><<<<>><>>>><<<>><<><>>>><<<<>><>>>><<>>><<<<>><>>><>>>><>>><<<><<<>>><<><<>>>><<<<><><<<<>><<<>>><<<><<>><<>><<<<><<>>><<>><<<<><<>><<<>><>>><>><<<<>><<<>><<<>>>><<<>>>><<<<>>>><>><><<<>>>><<<><<<>>><<>>><<>><<<>>><>>>><<<><>>><<><>>>><>><>><<<<>>>><<>><>>>><<>>><>>><<>>><>>>><<<>><<>>>><<<>>>><<><<<<>>><>>><>>><<<>>><<>>><<<<>>><<<>><>>><<<>>>><>>>><>><<<<>>><>>><>>><>>><<<<>>><<><<<>><<<>>><<<<>>><<<><<<>>><>><><>><<>>><<<<>>>><<<>>><<<><<<>>>><<<>>><<<<>>><<<<>>><<<<>>>><>>><<><<>><<>>><<<<>>><<>><<<<>>>><<<><>>>><<<>>>><<<>><<>><<><<>>>><<<<>><<>><<<<><<<<><<<<>>>><<>>>><<<>>><><<<<>>><>>><<>>>><<<>>>><<<>><>>>><<<<>>>><<<><<<>>>><<><<<<>>>><<>>>><<>><<><<<<><<>><<><<<<>>>><>><<<>>>><><<>>>><>>>><>>><<<<>><<><<<>><<>>>><><<><<>>><>><<<><<<>><<<<>><<>>><<<><<<<>>>><>>>><>><>>>><<<>><<><<<<><>>>><<>><<<>>><<<>>><<<>><<<<><><<<>>><<<<>><<<>>>><><<>>>><<>><<<>>><<<<><<<<><>><<>><><<><<>>>><<<>><><<><>><<<<><>><>><>>><<<>><<<>>>><<>><<>><<<<>><>>>><<<<>><>>>><<<<>>><><<<>>><<>><<<>>><<<<><<<>>><<>>>><<<>>><>>>><<<<>>><><>><><><<<>>>><>>>><<<>>><><<><<>>>><<<<>>><>><<<<>>>><>>>><>><>>><<<<>>><<>>><>>><<><<<><>><<><<>>>><<<<>><<>><<<<>>><<<><<><<>>><<<<>>>><<<<>>><<>>>><<<>>><<<<>>>><<<<>>>><<<<>><<<>>><<<<>>><<<>>><<<>><<<>>>><<<<>>>><>>><>>>><<<>>><<<>><<<><<><>>>><<><<>><<<<>>><><<<<><<>>>><<><<<>>><<>><<<<><>>><<>>><<<>>>><<><<<>>>><<><<>>>><><>>>><<>>><>><<>><<>><<><<<<>>>><<<><>><<<<><<<<>><<>><<<>>><<><<><<<<>>>><<<><<<<>>>><<<>><<>>>><<<>><<>><>><><<<>>>><<><<<<>>>><<<>>><<<>>><>>><<<>>><<<>>><<<><<>>><<>>><<<<><<<>><<<>>><<<<>>><<<<>><<<>>>><>><<<>>>><<>><<><<>>>><<<><<>>><<><<<><<<<><>>>><<>>>><<<<>><>><<<<>>><<<<>><>><<<<><><<>>><><<>><<<<>><>>><>>><<<<>>>><<<<><<>><><<<>><><<<<>>><>>>><<<>>>><>><>>>><<<>>>><<>>><<<<>>><<><>>><<<<><<<>>>><<>><<<<><<<>><<>>>><<><><<>><<<>>>><<<>><<><<<>>><<>>><>>><>>>><<>>><<<<>><<<><<>>><<<><<>>><>>><<<<>><<<>>><<>><<<<>><<><<>>><<>><<<><>>>><>><<<><>>><<>>>><<>><><<<<><<<><<<><<<>>><<<>>><<<<>><<<><><>><<<>>>><<>>><<<>><<>>><><>>><>><>>>><<>><<>>><<><<<>>><<<>>>><<<>><<<>>>><>><<><><<><<<<>><<<<>><<>>><<<><>>><<<><<<<>>><<<><<<>>>><<>><<<<>><<<><<>>>><<>><<<<>><<>><<>>><<<<>><<>><><<<><<<>><<<<><<>><>>>><<<>>><>>><<<>>>><<>>>><>>>><<<<>>>><>>>><>>><<<>>>><<>><<<><><<<><<<>>>><<<>>>><<<<>><<<>>>><<<>>>><<<>><><<<<>>>><>>><<<<>>>><<<<><>>><<<<><<<><<<<>>>><><<>>><<<<><<>>><>>><<>>>><>><<<<>>><<<>><>>><<><<<>>><<<<>>><<>>><<<>>><<>>>><<<<>>>><>>>><<<>><<<<>>><<><>><<>>><<<<><<>><<<<><<>>><<<<><<<><<<>>><<><>><<<<>>><<<<>><<<<>>><<><><>>>><>>><<<>>><><>>>><<<>>><>>>><<<>>>><<<>><<>>><<<>>><>>>><>>>><>>><<>>><<<><>><<<>>><<<>>><<<<>>>><<>>><<<<>><<<<>>><<<<><<<<>>><<>><<<<><<>>><<<>>>><<<>><<<><<>>>><<<>>>><><<>>><>>>><<<>><<<>>>><<<<>><>>>><<><<<>>>><<<<>><<<<>>><<>>><<<>>><><<<>>>><<<><<<><>><>>><><<<>>><><<<<>>>><<<<>>>><<<>>>><>>><<>>><>><<<<>>>><<>><<<<><<<<>><>>><<<<><<<<>><<<>>>><<<><<<<><<<<><>>><<<>>><<<<>><<<>>><<><<>>><<<>>><>><<><<>>><<<<>>>><><>>><<<><<<>><<<<>>><<<>><<>><<<>>><<<<><<<<>>>><<<<>><<>><<>>>><<><<<>>>><<<>>>><<<<>>><<<<><>>>><>>><<><<>>><<<>>>><>><<<><<>>>><<><<<>>><>><<>>><<<<>>>><<<>>>><>>><<><<<<><<><>>><<>><<>><<>><<<<>><<<<>>>><<<<>><<<><<>>>><>>>><>>><<<<>><<<><<>>><>>><>><<<>><><<>><<>>>><<><<<<><<<<>>><<>>>><<>><<<><<<<><<>>><<><<<>>>><<<<><>>>><<<<>>>><>>>><<>>>><>><>>><<><<<><<>>>><<<><<><<>>><<><<<<><<<>><<<<>><<><<<>><<<><<<>>><<>><<<>>><<<>>>><>>>><<<>>>><<>><><<>>>><<<<>><<<<>><<<>>>><><<>>>><<<>>>><<<>>>><<>><<<<>>><<<<>><<<>>>><>>><<<<>>><<<>>><><<<<>>><<<>><<>>>><<<>>><<<<>>><<>>>><<>>><<<<>>>><>>><<><<<<>>>><<<>>>><<<<>>><><<<<>><<<<>>><<>>><<<<>>>><<<><<<<>><<<<>>>><<>>><>><><<<>>><<<><>>><>>>><<<><><<><><>><<><>>><<<<>><<>>><<<>>>><>>>><<<<><<<>>><<<<>><<<><>>>><<<<>>><<<<>><<<<><<<<>><<<>>><<<>>><<>>>><>>><<>>>><<<><<><<>>>><<>><<><<<<>>>><><<>><<<>>><>><<<<><<<<>>><<>>><<>><<<>>><<<>><<>>><<<<>>><>>><>>>><>>><>>><>>>><<>><<<<>><<<<>>>><<<<><<<>>><<>>>><<<><<><<<>>><<>>>><<><><>>>><<<>>>><>><<><<<<><>>><>>>><<<>><<<<><<<<><>>><<<<><<>><<<<>>>><<<>>><<<><>>><<><<<<>><>>><<<<>>><<<>>><>>>><<<<>>>><>><<>>><<<><<><<<<>><<<>>>><><<<>><<<>>><<<><<>>><<<>><<<<>>>><<><<>><>><<>>>><<<>>><<>>><<<>>><>>>><>>>><<>>><<<>>>><>><>>>><<<>>>><><<><<<<>><><<>>><<<>>>><<<<><<<<>><<<<>>>><<<<>>><>>><>>><<>>>><><<><<<>>><<>>>><<<>>>><>>>><<>>>><<<><<><<<<>>>><<>>><<<<><<<><<>>>><<<<><<>>><>>>><<>>><<<<><<>><<<<>><<<>><<<><<<<><<<>>><>><<<>>>><<<<>>>><<<<>><<<<>><>><>>>><>>>><<>>><<<><>>><><<<<>>>><<>>><<><<<>>>><<>><<>><<<<>><<<<>>><<<><<>>><<<<>>>><<<>>>><<<>><<<<>><<<>>>><<<<>><>>>><<><<<>><<<><<<>>>><<<>>><<>>><<>>>><<<>>>><>>><<<<>>><>>>><<<>>>><<<><<>>><<<<>><<<>><>><>>><>>>><<><<<>>>><<<><<<><<<<><<<>>><<<<>>><>><<>>>><<<>><<<>>><<>>><>><<<<>>><<><<<<>><<>>>><<<<><<><>>>><<<>>><<<>><>><><<<<>>>><<<<><<<>>><<>><<>>><<<>>><>>><<<<>>>><<<>>><>><<><<<>>>><<<>>>><<<<>>>><<<><<<>>>><<<><<<>>><><<<>>><<>>><><<>>><>>>><<<>>><><<<<>>><<><<<>><>>><>><<<<>>><<<<><<<>>><>><<<<>>><<<>><<><<<<><<<><<>>>><<<<>><<>><<<><<>>>><<>>><<>>>><<<<>><<<<>>><<>>>><>>>><<<<>>><<<>>>><<<>>><>><<<<>>>><<<<>>>><<<><>>><<<<><<<<><<><<<>><<<<>>>><<>>>><<<>><<<<>>>><>>>><<<<>><<<>><<<<>>>><<<>>>><<<>>><>>><>>><<>>><<<>>><>>><<<<>>><<><<>><<<>>><<<<>>>><<<>><<<>><>><<<><<>>><<<<>>><<>><<>>><<<>>>><<<<><><>>>><>><<<>><<<<><<<<>>><<<>><<>><<>><<><<<>>>><>><<><<<<>><<<<>>>><<<<><<<<>><<<<><<<<><<<>>>><<<><<<>>><<<>>><>>><<>>>><<<<>>><>>>><<<<>><<<<><<<><<<><>><><<<<>>>><<>>>><<<<>>>><<>>><<<<>>>><<<>>>><<>>><<<<><<>><<<<><>>>><<<>>>><><<<<>>><<>>><<><<<>>><<>><>>><<>><><<<<>><<<<><<>><>>>><>>>><<>><<<>>><<<<>><<<>>><<<><<<<>>><>>><<>><<<<>>>><<<<>>>><>>>><<<<><>>>><<<<><<<>><<<<>>><>>><>><><<<>>>><<>>><<<<>><>><<<>><<>>><>><<>>><<>>><>>><>><<>>>><>>>><<<>>>><<<>>><>><<><<>>>><<>><<<<>>><<><><<>>>><<<>><>>>><<<>><<<<>>><<<<>><<>>>><<<>>><<<<><>>>><><<<>>><<<<>>><<<<>>><>>><<>><<<>><>>>><<>><><<<>><<<<>>>><>>><>><<<<>>>><<<>>>><>><<><<<>><<<<>>><<<>>><>>>><>><>><<<<>>><>>>><<>>>><<<>><<<>>>><<<<><<<><><<<<>><<>>><<>><<>>>><<>>>><<<<>>><<<>><<>>>><<<<><<<>>><<<>>>><<<<>><<<>><<<<>>><<>>><>>>><<<<>><<>>>><<<<>>>><<>><<<<>>>><><<<<>><<<>><<<<>>><<<<><<<<>>>><<<>><<>>>><<<<>><<>>><<>><<>>>><<<<>><<>><<>>>><<><<<>><<>>>><<>><<>>>><<<>><>>>><<>><<<>>>><<>>>><>><<>><<<>>>><<<<>><>>>><<<>><><<<<>>><<<<><<>>>><<<<>><<<<>><<<<>>><>>><<<>>>><<<<><<<<>>><<<>>>><<>><><<<<>>>><<<<>>><<<>>>><<>>>><<>><<<<>><<<<><<<<>>>><<<>>>><<<>>><>>><<<><<<>><<>>><>><<<>>>><<>><>>><<<>>><<<>>><<<>>>><>>><<<>>>><>>>><<<>>><<<<>>><<<>><<>><<<<>><<<<><<<<>><<<<><<<<>>>><<>>><<<>><<>><<<>><<>>>><>><<<<>><<<>>>><>><>>>><<>>><<>><<<<>>>><<><<<>><<<<><>>><<<<>>><>><<<>>><>><>><>><<<>><>>>><<<>>>><<<>>>><<<>><<<<>><<<><<>>><<>>>><>>>><<>>>><<<<>>><<<<><>>><<<<><<>>><<<>>>><<<><<<<>><<<>>>><<<><<<<>><<><<<<>><<<<>><<<>><><><<<>>><><<<>><<<<>><<><<>>><<<>>><<<>><<><<<>>>><<<>><<>>>><<<>>>><>><<<>>><<<<>><><<>>><<<<>>>><><<<<>><<<>><<<>>><<<>><<<<><<><<<><<<>><<<<>>>><<<<>>>><<<<>>>><<>>><<<<>>><<<<>>>><<<><<>><<<<>>>><<>><<>>><<>>>><<>><<>><><<><<><<<<>><>><<><>>><>>><<<><<<>>>><<>>>><<>>><<<>>><<<<>><>>>><<>>>><<><<<<>><<<<>><><<<>><>>>><<><>>>><<<>>>><><>><<><<><><<<>>><<<<>>><<>><<<>>>><<<<>>><<><>>><><<>>><<<><<><<<>>>><<<<>>><<<>><<<<>><<><<<>><<<<><<<><<<<>>><<<<>>><<<>>>><<><<<>>><>>><<>>><><<>>><<<<><<>><<>>><>>><<<<>>><<<<><<>>>><<>>><<>><<<<><>>>><<<>>>><>><<>>>><<<<>>><>><>>><<<>>>><><<<<>><<<<>>>><<<>>><>>>><<>>><><<<<><>>>><<>>><<<<><<<>>>><<<>>><>>>><><>>><<>><>><>><<<>><<<<>><<<><<>>>><<<>>><><<<>><>><<<<>><<>><<<<><<<<>><<<>>>><<<><<<<>>>><<>><<><<<>><>><<<>>>><<>>><<<<><><>>>><>><<<>><<<<><>>><<>>><><>>><<>>>><><<<>>>><<<>>><<<>><>><<>>>><><>><<<<>>>><<<><<<>>><<><<<<><<>>>><<>>>><<<>>>><>>>><<<<>>>><<<>><<<<>><<><<<<>>><<<>>>><<<><<<>>>><<<<>>>><><>>>><<><<<<><>>>><>>>><<<>>><<>>>><<<>>><<<>><<>>>><<>><><<>><<>>><><>>>><>>><<<<>>><<<<>><<<<>>>><<>><<<<>><<<<><<<<>>>><><<><<>>>><<<>><<<<><<<>>>><<<>>><<><<>><<<><<<>>>><><><<<<><><>>>><<>>>><<>><<<<><<<>>><<<><>>><<<<>>>><<<<>>>><<>>><<<<>><<<<>>><<>><<>>><<>>>><>>>><<>>>><>>>><<>>>><<<>><>>><<><<<>>><>><<>><<>>><>>>><<><<>>>><>><<<>>><<>>>><<<<>>><><<>><<>><<<><<<<>>>><<>>>><>><<<>><<<<>><<<<>>><<>>>><<<<><<>><<<><><<>>>><<>>>><<<>>><<<<>>>><<<>>>><<>>><<<<>>><>><<<<>>><<<>>><<>>>><>>>><<<><<>><>><<<<><>>>><>><<<>><>><>>><<<><>>><<<<>><<>>>><>>>><<>>>><<>><<<<>>>><>><<<>>><>>><<>>>><<>>><<<<>>>><<<><<<<>><<<>>>><<<><<<>><<<<>><<<>>><<>>>><><<<>><<<>><<<><<<<>>><<<>>>><<<<>><<>><<<>>><<<<><<<><><<<<>><<<<>>>><<><<<>><<>>>><<>>>><>>>><<>><<<><<>>>><<>><<<>>><<<>>>><>>><>><<<>>>><<><<>>><<<<>>>><<<><<<>><>><<><<<<><<<>>>><<<>>>><<<<>>>><<>><<>><<<<>><>><<>><<>>><<<<>><<<<><<<<>>>><<<>>>><<><<>>>><<<>>><>><<>>><<<<>><<<>>>><<<<>>>><<<<>>>><>>>><><><<<<><<>>><>><<>>><>><<<>>>><<>><<>>><<<<>><<><<>><<<<>><<<<><<<<>><<<<>><<<>><<<<>>><>>>><<>>><>>><<>>>><<>><<<>>><<<>>><<<>><>><<<<>>>><>><>>><<>>>><<>>>><<<>>>><<<<>>>><<<><<<>>>><>><<<>>>><<><<<><>><<<<>>>><<<>>><<<>>>><<><<>>>><<<<>>"

rocks = [
    ((3, 2), (3, 3), (3, 4), (3, 5)),
    ((1, 3), (2, 2), (2, 3), (2, 4), (3, 3)),
    ((1, 4), (2, 4), (3, 2), (3, 3), (3, 4)),
    ((0, 2), (1, 2), (2, 2), (3, 2)),
    ((2, 2), (2, 3), (3, 2), (3, 3))
    ]

def check_collision(grid, rock, pos):
    for square in rock:
        if grid[square[0] + pos[0], square[1] + pos[1]] != 0:
            return True
    return False

height = 0
heights = {}

jet_pos = 0
jet_len = len(jets)

grid = np.zeros([100, 9], dtype = int)
grid[7:, :] = 1
grid[:, 0] = 1
grid[:, -1] = 1

target = np.inf

i = -1
while True:
    i += 1

    if i == 2022:
        print(f"Part one: {height}")
    elif i == target:
        print(f"Part two: {height + extra_height}")
        break

    rock = rocks[i % 5]
    pos = [0, 1]

    while True:

        if jet_pos == 0 and height > 0:
            heights[i] = height

            if len(heights) == 2:
                gap = max(heights.keys()) - min(heights.keys())
                diff = max(heights.values()) - min(heights.values())

                extra_height = ((1000000000000 - i) // gap) * diff
                target = ((1000000000000 - i) % gap) + i

        if jets[jet_pos] == "<":
            if not check_collision(grid, rock, (pos[0], pos[1] - 1)):
                pos[1] -= 1
        elif jets[jet_pos] == ">":
            if not check_collision(grid, rock, (pos[0], pos[1] + 1)):
                pos[1] += 1
        
        jet_pos = (jet_pos + 1) % jet_len

        if not check_collision(grid, rock, (pos[0] + 1, pos[1])):
            pos[0] += 1
        else:
            break
    
    for square in rock:
        grid[square[0] + pos[0], square[1] + pos[1]] = 1
    
    while sum(grid[6, :]) > 2:

        for j in range(99, 0, -1):
            grid[j, :] = grid[j - 1, :]
        
        height += 1
